(function(e){function t(t){for(var r,i,s=t[0],c=t[1],u=t[2],f=0,d=[];f<s.length;f++)i=s[f],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},2395:function(e,t,n){},"530e":function(e,t,n){"use strict";n("757b")},"757b":function(e,t,n){},"7c55":function(e,t,n){"use strict";n("2395")},cd49:function(e,t,n){"use strict";n.r(t);var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],i=(n("7c55"),n("2877")),s={},c=Object(i["a"])(s,o,a,!1,null,null,null),u=c.exports,l=n("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home",staticStyle:{"text-align":"center"}},[n("button",{on:{click:function(t){return e.Start()}}},[e._v("Start")]),n("div",[e._v("Status: "),n("span",{domProps:{innerHTML:e._s(e.StatusConnect)}})]),n("div",{staticClass:"mic-name"}),e._m(0),e._m(1)])},d=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b",[e._v("Microphone Vol:")]),e._v(" "),n("span",{staticClass:"volLevel"}),e._v("; "),n("b",[e._v("Max Vol:")]),e._v(" "),n("span",{staticClass:"maxLevel"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pids-wrapper"},[n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"}),n("div",{staticClass:"pid"})])}],p=n("9ab4"),v=n("1b40"),y=n("af24"),b=n("bc3a"),h=n.n(b),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p["b"])(t,e),t.prototype.created=function(){this.timeInterval=1e3,this.maxVolPerTime=0,this.ChangeStatus(!1),this.ConnectToServer()},t.prototype.ChangeStatus=function(e){this.StatusConnect=1==e?'<font color="green">Online<font>':'<font color="green">Offline<font>',this.$forceUpdate()},t.prototype.OutputPlayerAudio=function(e){var t=new Blob([e],{type:"audio/webm;codecs=opus"}),n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var e=n.result,t=new Audio(e);t.play()}},t.prototype.AnalyticVoice=function(e){var t=this,n=new(window.AudioContext||window.webkitAudioContext),r=n.createAnalyser(),o=n.createMediaStreamSource(e),a=n.createScriptProcessor(2048,1,1),i=document.querySelector(".volLevel"),s=document.querySelector(".maxLevel"),c=[],u=document.querySelectorAll(".pid");u.forEach((function(e){c.push(e)}));var l=function(e){for(var t=Math.round(e/5),n=c.slice(0,t),r=0;r<c.length;r++)c[r].style.backgroundColor="#e6e7e8";for(r=0;r<n.length;r++)n[r].style.backgroundColor="#69ce2b"};r.smoothingTimeConstant=.8,r.fftSize=1024,o.connect(r),r.connect(a),a.connect(n.destination),a.addEventListener("audioprocess",(function(){var e=new Uint8Array(r.frequencyBinCount);r.getByteFrequencyData(e);for(var n=0,o=e.length,a=0;a<o;a++)n+=e[a];var c=n/o;c>10&&c>t.maxVolPerTime&&(t.maxVolPerTime=c),s.innerHTML=String(Math.round(t.maxVolPerTime)),i.innerHTML=String(Math.round(c)),l(c)}))},t.prototype.Start=function(){var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e.AnalyticVoice(t);var n=new window.MediaRecorder(t),r=[];e.maxVolPerTime=0,n.start(),n.addEventListener("dataavailable",(function(e){r.push(e.data)})),n.addEventListener("stop",(function(){if(r.length>0&&e.maxVolPerTime>0){var t=r[0].type,o=new Blob(r,{type:t});o.arrayBuffer().then((function(e){var t=new Uint8Array(e);window.SendPlayerTick(t)}))}r=[],e.maxVolPerTime=0,n.start(),setTimeout((function(){n.stop()}),e.timeInterval)})),setTimeout((function(){n.stop()}),e.timeInterval)}))},t.prototype.ConnectToServer=function(){var e=this,t=0,n=9991,r=9992,o=9993,a=9994,i=9996,s=function(e,t,n){void 0===n&&(n=!1);var r=1==n?0:36,o="";0==n&&(e.offset=t,o=e.readUtf8String(r)),e.offset=t+r+0;var a=e.readUInt32LE(),i={x:0,y:0,z:0};e.offset=t+r+4+0,i.x=e.readFloatLE(),e.offset=t+r+4+4,i.y=e.readFloatLE(),e.offset=t+r+4+8,i.z=e.readFloatLE(),e.offset=t+r+4+12;var s=e.readUInt8();return{uuid:o,id:a,position:i,state:s}},c=function(e,t,r){var o=new Uint8Array(17+r.byteLength),a=new Uint8Array(new Uint32Array([n]).buffer);o.set(a,0),o.set(new Uint8Array(new Float32Array([e.x]).buffer),4),o.set(new Uint8Array(new Float32Array([e.y]).buffer),8),o.set(new Uint8Array(new Float32Array([e.z]).buffer),12),o.set(new Uint8Array([t]),16),o.set(r,17),u.send(o)};window.SendPlayerTick=function(e){return c({x:0,y:0,z:0},0,e)};var u=new WebSocket("wss://getway.dev.viexpo.ru:10010");u.binaryType="arraybuffer",u.onmessage=function(t){var n=new y["BufferStream"](t.data);n.offset=0;var c=n.readInt32LE();switch(c){case a:n.offset=4;for(var u=n.readUInt32LE(),l=[],f=0;f<u;f++){var d=s(n,8+53*f);l.push(d)}console.log("Method: FromMovement_FromPlayerScene_PlayerList, count: "+u,l);break;case r:var p=s(n,4);console.log("User Join: "+p.uuid);break;case o:n.offset=4;var v=n.readUtf8String(36);console.log("User Leave: "+v);break;case i:var b=s(n,4,!0),h=new Uint8Array(n.buffer.buffer,21);e.OutputPlayerAudio(h),console.log("FromSound_FromPlayerScene_PlayerVoice => ",b);break;default:console.log("Method: Unknown");break}},u.onclose=function(){e.ChangeStatus(!1),setTimeout((function(){e.ConnectToServer()}),1e3)},u.onopen=function(){e.ChangeStatus(!0),h.a.get("https://getway.dev.viexpo.ru/api/account/fake/get").then((function(e){var n=e.data.response.session_uuid,r=new Uint8Array(77),o=new Uint8Array(new Uint32Array([t]).buffer),a=(new TextEncoder).encode(n),i=(new TextEncoder).encode("123456789012345678901234567890123456");r.set(o,0),r.set(a,4),r.set(new Uint8Array([0]),40),r.set(i,41),u.send(r)}))}},t=Object(p["a"])([Object(v["a"])({components:{}})],t),t}(v["b"]),w=m,g=w,S=(n("530e"),Object(i["a"])(g,f,d,!1,null,"0e9284d2",null)),C=S.exports;r["a"].use(l["a"]);var x=[{path:"/",name:"Home",component:C}],_=new l["a"]({routes:x}),A=_;r["a"].config.productionTip=!1,new r["a"]({router:A,render:function(e){return e(u)}}).$mount("#app")}});
//# sourceMappingURL=app.e9d85330.js.map